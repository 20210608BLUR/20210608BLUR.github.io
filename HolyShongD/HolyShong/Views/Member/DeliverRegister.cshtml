@model DeliverRegisterViewModel


@if (Model.IsVerifying)
{
    //已註冊，認證中
    <div class="container deliverRegisterapp veryfyContainer">
        <div class="row justify-content-center veryfyRow">
            <div class="captionItem col col-md-6 text-center veryfycol">
                <p>已收到您的外送員註冊申請</p>
                <p>請耐心等候3~5個工作天</p>
                <p>HolyShong審查後會主動與您聯繫</p>
                <a class="loginShow btn btn btn-dark  w-100 mb-2" onclick="location.href='@Url.Action("index", "Home")'">返回首頁開始點餐</a>
            </div>
        </div>
    </div>
}
else
{
    //新註冊
    using (Html.BeginForm())
    {
        @Html.HiddenFor(x => x.MemberId);
        <div class="container deliverRegisterapp">
            <div class="row">
                <div class="captionItem col-12 col-xl-5">
                    <div class="caption">
                        <h1>Deliver with HolyShong in Taiwan</h1>
                        <h4>No boss. Flexible schedule. Quick pay.</h4>
                        <p>
                            Now you can earn cash by delivering the HolyShong food orders that people crave—all while
                            exploring your city.
                        </p>
                    </div>
                    <div class="captionPic">
                        <img src="~/Assets/Images/deliverRegister.png" alt="圖片">
                    </div>
                </div>
                <div class="space col-xl-1"></div>
                <div class="signInItem col-12 col-xl-6">
                    <div class="row">
                        <div class="signIn col-12">
                            <h3>立即註冊</h3>
                            <p>須執行以下步驟來完成帳戶設定</p>
                        </div>
                        <div class="accordion" id="accordionExample">
                            <div class="card">
                                <div class="card-header" id="headingOne">
                                    <h2 class="mb-0">
                                        <button class="fileTxt btn btn-link btn-block text-left" type="button"
                                                data-toggle="collapse" data-target="#collapseOne" aria-expanded="true"
                                                aria-controls="collapseOne">
                                            駕照+身分證(需拍於同一個畫面)
                                        </button>
                                    </h2>
                                </div>
                                <div id="collapseOne" class="collapse" aria-labelledby="headingOne"
                                     data-parent="#accordionExample">
                                    <div class="fileOne">
                                        <label class="btn btn-info btn-dark" v-on:click="uploadIdAndlicense" for="IdentityAndLicenseImg">
                                            <i class="fa fa-photo"></i>上駕照+身分證
                                        </label>
                                        <input type="text" v-model="IdAndlicense" id="IdAndlicenseForCloudnary" style="display: none;" name="IdentityAndLicenseImg">
                                        <i v-show="IdAndlicense !=''" class="fas fa-check text-success"></i>
                                        <div class="text-danger small mt-1">{{check.checkIdAndlicenseMsg}}</div>
                                    </div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-header" id="headingTwo">
                                    <h2 class="mb-0">
                                        <button class="fileTxt btn btn-link btn-block text-left collapsed" type="button"
                                                data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false"
                                                aria-controls="collapseTwo">
                                            機車強制險(僅接受電子檔或正本)
                                        </button>
                                    </h2>
                                </div>
                                <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo"
                                     data-parent="#accordionExample">
                                    <div class="fileTwo">
                                        <label class="btn btn-info btn-dark" v-on:click="uploadInsuranceImg " for="InsuranceImg">
                                            <i class="fa fa-photo"></i>機車強制險
                                        </label>
                                        <input type="text" v-model="InsuranceImg" id="InsuranceImgForCloudnary" style="display: none;" name="InsuranceImg">
                                        <i v-show="InsuranceImg !=''" class="fas fa-check text-success"></i>
                                        <div class="text-danger small mt-1">{{check.checkInsuranceImgMsg}}</div>
                                    </div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-header" id="headingFour">
                                    <h2 class="mb-0">
                                        <button class="fileTxt btn btn-link btn-block text-left collapsed" type="button"
                                                data-toggle="collapse" data-target="#collapseFour" aria-expanded="false"
                                                aria-controls="collapseFour">
                                            個人大頭照
                                        </button>
                                    </h2>
                                </div>
                                <div id="collapseFour" class="collapse" aria-labelledby="headingFour"
                                     data-parent="#accordionExample">
                                    <div class="fileFour">
                                        <label class="btn btn-info btn-dark" v-on:click="uploadHeadshotImg " for="HeadshotImg">
                                            <i class="fa fa-photo"></i>個人大頭照
                                        </label>
                                        <input type="text" v-model="HeadshotImg" id="HeadshotImgForCloudnary" style="display: none;" name="HeadshotImg">
                                        <i v-show="HeadshotImg !=''" class="fas fa-check text-success"></i>
                                        <div class="text-danger small mt-1">{{check.checkHeadshotImgMsg}}</div>
                                    </div>
                                </div>
                            </div>
                            <div class="card">
                                <div class="card-header" id="headingFive">
                                    <h2 class="mb-0">
                                        <button class="fileTxt btn btn-link btn-block text-left collapsed" type="button"
                                                data-toggle="collapse" data-target="#collapseFive" aria-expanded="false"
                                                aria-controls="collapseFive">
                                            良民證
                                        </button>
                                    </h2>
                                </div>
                                <div id="collapseFive" class="collapse" aria-labelledby="headingFive"
                                     data-parent="#accordionExample">
                                    <div class="fileFive">
                                        <label class="btn btn-info btn-dark" v-on:click="uploadPoliceCriminalRecordImg " for="PoliceCriminalRecordImg">
                                            <i class="fa fa-photo"></i>個人大頭照
                                        </label>
                                        <input type="text" v-model="PoliceCriminalRecordImg" id="HeadshotImgForCloudnary" style="display: none;" name="PoliceCriminalRecordImg">
                                        <i v-show="PoliceCriminalRecordImg !=''" class="fas fa-check text-success"></i>
                                        <div class="text-danger small mt-1">{{check.checkPoliceCriminalRecordImgMsg}}</div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>

                    <div class="description">
                        <p>
                            繼續操作即表示本人同意 Uber 的使用條款，並確認已閱讀隱私政策。<br><br>
                            我亦同意 Uber 或其代表可透過我提供的電子郵件、電話、或簡訊與我聯絡 (包含透過自動方式)，而上述聯絡方式可包含銷售用途。
                        </p>
                    </div>
                    <div class="deliverBtnAndSignIn">
                        <button type="submit" :disabled="!isVerify" class="btn btn-dark">註冊成為合作外送夥伴</button>
                    </div>
                </div>
            </div>
        </div>
    }

}

}
@section endJS{
    <script>
        var cloud_url = 'https://api.cloudinary.com/v1_1/dvyxx4jau/image/upload';
        var cloud_upload_preset = 'di5kimai';
        let deliverRegisterapp = new Vue({
            el: '.deliverRegisterapp',
            data: {
                isVerify: true,
                IdAndlicense: "",
                InsuranceImg: "",
                HeadshotImg: "",
                PoliceCriminalRecordImg: "",
                check: {
                    checkIdAndlicenseError: false,
                    checkIdAndlicenseMsg: "",
                    checkInsuranceImgError: false,
                    checkInsuranceImgMsg: "",
                    checkHeadshotImgError: false,
                    checkHeadshotImgMsg: "",
                    checkPoliceCriminalRecordImgrror: false,
                    checkPoliceCriminalRecordImgMsg: "",
                },
            },
            watch: {
                'IdAndlicense': {
                    immediate: true,//進入畫面立即檢查
                    handler() {
                        if (this.IdAndlicense == '') {
                            this.check.checkIdAndlicenseError = true;
                            this.check.checkIdAndlicenseMsg = '上傳身分證及駕照';
                        }
                        else {
                            this.check.checkIdAndlicenseError = false;
                            this.check.checkIdAndlicenseMsg = '';
                        }
                        this.checkVerify();
                    }
                },
                'InsuranceImg': {
                    immediate: true,//進入畫面立即檢查
                    handler() {
                        if (this.InsuranceImg == '') {
                            this.check.checkInsuranceImgError = true;
                            this.check.checkInsuranceImgMsg = '請上傳強制險';
                        }
                        else {
                            this.check.checkInsuranceImgError = false;
                            this.check.checkInsuranceImgMsg = '';
                        }
                        this.checkVerify();
                    }
                },
                'HeadshotImg': {
                    immediate: true,//進入畫面立即檢查
                    handler() {
                        if (this.HeadshotImg == '') {
                            this.check.checkHeadshotImgError = true;
                            this.check.checkHeadshotImgMsg = '請上傳大頭照';
                        }
                        else {
                            this.check.checkHeadshotImgError = false;
                            this.check.checkHeadshotImgMsg = '';
                        }
                        this.checkVerify();
                    }
                },
                'PoliceCriminalRecordImg': {
                    immediate: true,//進入畫面立即檢查
                    handler() {
                        if (this.PoliceCriminalRecordImg == '') {
                            this.check.checkPoliceCriminalRecordImgrror = true;
                            this.check.checkPoliceCriminalRecordImgMsg = '請上傳餐廳照片';
                        }
                        else {
                            this.check.checkPoliceCriminalRecordImgrror = false;
                            this.check.checkPoliceCriminalRecordImgMsg = '';
                        }
                        this.checkVerify();
                    }
                },
            },
            methods: {
                checkVerify() {
                    for (let prop in this.check) {
                        if (this.check[prop] == true) {
                            this.isVerify = false;
                            return;
                        }
                    }
                    this.isVerify = true;
                },
                uploadIdAndlicense() {
                    //let vm = this;
                    let input = document.createElement('input')
                    input.type = 'file';
                    input.click()

                    input.onchange = function () {
                        var file = input.files[0];
                        var formData = new FormData();

                        formData.append('file', file);
                        formData.append('upload_preset', cloud_upload_preset);

                        axios({
                            url: cloud_url,
                            method: 'POST',
                            Headers: {
                                'Content-Type': 'multipart/form-data'
                            },
                            data: formData
                        }).then(function (res) {
                            console.log(res);
                            deliverRegisterapp.IdAndlicense = res.data.secure_url

                        }).catch(function (err) {
                            console.error(err);

                        });
                    }
                },
                uploadInsuranceImg() {
                    //let vm = this;
                    let input = document.createElement('input')
                    input.type = 'file';
                    input.click()

                    input.onchange = function () {
                        var file = input.files[0];
                        var formData = new FormData();

                        formData.append('file', file);
                        formData.append('upload_preset', cloud_upload_preset);

                        axios({
                            url: cloud_url,
                            method: 'POST',
                            Headers: {
                                'Content-Type': 'multipart/form-data'
                            },
                            data: formData
                        }).then(function (res) {
                            console.log(res);
                            deliverRegisterapp.InsuranceImg = res.data.secure_url

                        }).catch(function (err) {
                            console.error(err);

                        });
                    }
                },
                uploadHeadshotImg() {
                    //let vm = this;
                    let input = document.createElement('input')
                    input.type = 'file';
                    input.click()

                    input.onchange = function () {
                        var file = input.files[0];
                        var formData = new FormData();

                        formData.append('file', file);
                        formData.append('upload_preset', cloud_upload_preset);

                        axios({
                            url: cloud_url,
                            method: 'POST',
                            Headers: {
                                'Content-Type': 'multipart/form-data'
                            },
                            data: formData
                        }).then(function (res) {
                            console.log(res);
                            deliverRegisterapp.HeadshotImg = res.data.secure_url

                        }).catch(function (err) {
                            console.error(err);

                        });
                    }
                },
                uploadPoliceCriminalRecordImg() {
                    //let vm = this;
                    let input = document.createElement('input')
                    input.type = 'file';
                    input.click()

                    input.onchange = function () {
                        var file = input.files[0];
                        var formData = new FormData();

                        formData.append('file', file);
                        formData.append('upload_preset', cloud_upload_preset);

                        axios({
                            url: cloud_url,
                            method: 'POST',
                            Headers: {
                                'Content-Type': 'multipart/form-data'
                            },
                            data: formData
                        }).then(function (res) {
                            console.log(res);
                            deliverRegisterapp.PoliceCriminalRecordImg = res.data.secure_url

                        }).catch(function (err) {
                            console.error(err);

                        });
                    }
                },
            }
        })
    </script>
}

@section topCSS
{
    <style>
        .header {
            background-color: black;
            height: 64px;
        }

        footer {
            position: relative;
            bottom: 0;
            width: 100%;
        }

        /* 圖文 */
        .container {
            max-width: 1920px;
        }

        .captionItem {
            margin-top: 80px;
            padding-right: 0;
            padding-left: 0;
        }

        .caption h4 {
            font-weight: bold;
            font-size: 18px;
        }

        .caption p {
            font-size: 16px;
        }

        .caption {
            padding: 24px 20px 0
        }

            .caption h1 {
                font-size: 36px;
                margin-bottom: 20px;
            }

        .captionPic {
            padding: 0 20px;
            width: 100%;
            height: 211px;
        }

            .captionPic img {
                width: 100%;
                height: 100%;
                object-fit: cover;
            }

        /* 註冊 */
        .fileTxt:focus {
            box-shadow: 0 0 0 0.2rem rgb(146 193 255);
        }

        .accordion {
            padding: 0 20px;
            width: 100%;
        }

        .fileOne, .fileTwo, .fileThree, .fileFour, .fileFive {
            padding: 15px 30px;
        }

        .fileTxt {
            color: black;
        }

        .signInItem .signIn {
            padding: 0 20px;
            margin: 28px 0;
        }

        .description {
            font-size: 12px;
            margin: 24px 0;
        }

        .deliverBtnAndSignIn .btn {
            padding: 14px 25px;
        }

        .deliverBtnAndSignIn {
            margin-bottom: 10px;
        }

        .deliverSignIn {
            font-size: 12px;
            margin-top: 10px;
        }

            .deliverSignIn span {
                margin-right: 4px;
            }

        /*審查中*/
        .veryfyContainer {
            height: 68vh;
            position: relative;
            top: 30vh;
        }

        .veryfyRow {
            position: relative;
        }

        .veryfyRow {
        }

        @@media screen and (min-width: 768px) and (max-width:991px) {
            .captionPic {
                width: 100%;
                height: 500px;
            }

            .deliverBtnAndSignIn {
                display: flex;
                align-items: baseline;
                margin-bottom: 10px;
            }

            .deliverSignIn {
                margin-left: 15px;
            }
        }

        @@media screen and (min-width: 992px) {
            .captionItem {
                margin-top: 0;
            }

            .signInItem .signIn {
                padding: 0;
            }

            .accordion {
                padding: 0;
            }

            .caption h1 {
                font-size: 52px;
            }

            .caption {
                padding: 64px;
            }

            .captionPic {
                padding: 0;
                width: 80%;
                height: 50%;
                margin: auto;
            }

                .captionPic img {
                    width: 100%;
                    height: 500px;
                }

            .signInItem {
                padding: 73px;
            }

            .personalInfo {
                line-height: 33px;
            }

            .deliverBtnAndSignIn {
                display: flex;
                align-items: baseline;
            }

            .deliverSignIn {
                margin-left: 15px;
            }
        }

        @@media screen and (min-width: 1025px) {
            .captionPic img {
                height: 350px;
            }
        }
    </style>
}


@section topJS{
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
            integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
            crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-Piv4xVNRyMGpqkS2by6br4gNJ7DXjqk09RmUpJ8jgGtD7zP9yug3goQfGII0yAns"
            crossorigin="anonymous"></script>
    <script src="//unpkg.com/vue@latest/dist/vue.min.js"></script>
    <script src="//unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.min.js"></script>
    <!-- Load the following for BootstrapVueIcons support -->
    <script src="//unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue-icons.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"
            integrity="sha512-bZS47S7sPOxkjU/4Bt0zrhEtWx0y0CRkhEp8IckzK+ltifIIE9EMIMTuT/mEzoIMewUINruDBIR/jJnbguonqQ=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>
}